!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var s=i(1),o=n(s);if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";var r=AFRAME.utils.device.isMobile()||window.hasNonPolyfillWebVRSupport;AFRAME.registerComponent("mouse-cursor",{schema:{objects:{type:"string",default:"a-scene"},recursive:{default:!0}},init:function(){console.debug("init"),this.__raycaster=new THREE.Raycaster,this.__mouse=new THREE.Vector2,this.__isMobile=this.el.sceneEl.isMobile,this.__isStereo=!1,this.__active=!1,this.__isDown=!1,this.__intersectedEl=null,this.__attachEventListeners(),this.objects=[]},update:function(e){this.__refreshObjects()},remove:function(){this.__removeEventListeners(),this.__raycaster=null;var e=this.__refreshObjects.bind(this);this.objects.forEach(function(t){t.removeEventListener("child-attached",e)})},pause:function(){this.__active=!1},play:function(){this.__active=!0},__attachEventListeners:function(){var e=this.el,t=e.sceneEl,i=t.canvas;return i?(t.addEventListener("enter-vr",this.__onEnterVR.bind(this)),t.addEventListener("exit-vr",this.__onExitVR.bind(this)),i.addEventListener("mousedown",this.__onDown.bind(this)),i.addEventListener("mousemove",this.__onMouseMove.bind(this)),i.addEventListener("mouseup",this.__onRelease.bind(this)),i.addEventListener("mouseout",this.__onRelease.bind(this)),i.addEventListener("touchstart",this.__onDown.bind(this)),i.addEventListener("touchmove",this.__onTouchMove.bind(this)),i.addEventListener("touchend",this.__onRelease.bind(this)),e.addEventListener("componentchanged",this.__onComponentChanged.bind(this)),void t.addEventListener("loaded",this.__refreshObjects.bind(this))):void e.sceneEl.addEventListener("render-target-loaded",this.__attachEventListeners.bind(this))},__removeEventListeners:function(){var e=this.el,t=e.sceneEl,i=t.canvas;i&&(t.removeEventListener("enter-vr",this.__onEnterVR.bind(this)),t.removeEventListener("exit-vr",this.__onExitVR.bind(this)),i.removeEventListener("mousedown",this.__onDown.bind(this)),i.removeEventListener("mousemove",this.__onMouseMove.bind(this)),i.removeEventListener("mouseup",this.__onRelease.bind(this)),i.removeEventListener("mouseout",this.__onRelease.bind(this)),i.removeEventListener("touchstart",this.__onDown.bind(this)),i.removeEventListener("touchmove",this.__onTouchMove.bind(this)),i.removeEventListener("touchend",this.__onRelease.bind(this)),e.removeEventListener("componentchanged",this.__onComponentChanged.bind(this)))},__isActive:function(){return!(!this.__active&&!this.__raycaster)},__onDown:function(e){this.__isActive()&&(this.__isDown=!0,this.__updateMouse(e),this.__updateIntersectObject(),this.__isMobile||this.__setInitMousePosition(e))},__onRelease:function(){if(this.__isActive()){if(this.__defMousePosition){var e=Math.abs(this.__initMousePosition.x-this.__defMousePosition.x),t=Math.abs(this.__initMousePosition.y-this.__defMousePosition.y),i=Math.max(e,t);i>.04&&(this.__isDown=!1)}this.__isDown&&this.__intersectedEl&&this.__emit("click"),this.__isDown=!1,this.__resetMousePosition()}},__onMouseMove:function(e){this.__isActive()&&(this.__updateMouse(e),this.__updateIntersectObject(),this.__isDown&&this.__setMousePosition(e))},__onTouchMove:function(e){this.__isActive()&&(this.__isDown=!1)},__onEnterVR:function(){r&&(this.__isStereo=!0)},__onExitVR:function(){this.__isStereo=!1},__onComponentChanged:function(e){"position"===e.detail.name&&this.__updateIntersectObject()},__getPosition:function(e){var t=window,i=t.innerWidth,n=t.innerHeight,s=void 0,o=void 0;if(this.__isMobile){var r=e.touches;if(!r||1!==r.length)return;var _=r[0];s=_.pageX,o=_.pageY}else s=e.clientX,o=e.clientY;this.__isStereo&&(s=s%(i/2)*2);var h=s/i*2-1,c=2*-(o/n)+1;return{x:h,y:c}},__updateMouse:function(e){var t=this.__getPosition(e);null!==t&&(this.__mouse.x=t.x,this.__mouse.y=t.y)},__setMousePosition:function(e){this.__defMousePosition=this.__getPosition(e)},__setInitMousePosition:function(e){this.__initMousePosition=this.__getPosition(e)},__resetMousePosition:function(){this.__initMousePosition=this.__defMousePosition=null},__getChildren:function(e){var t=this;return e.children.map(function(e){return"Group"===e.type?t.__getChildren(e):e})},__getAllChildren:function(){var e=this.__getChildren(this.el.sceneEl.object3D);return(0,o.default)(e)},__updateIntersectObject:function(){var e=this,t=this.__raycaster,i=this.el,n=this.__mouse,s=(i.sceneEl.object3D,this.el.getObject3D("camera"));this.__getAllChildren(),t.ray.origin.setFromMatrixPosition(s.matrixWorld),t.ray.direction.set(n.x,n.y,.5).unproject(s).sub(t.ray.origin).normalize();var o=this.__getAllChildren(),r=t.intersectObjects(o);if(r.length>0){var _=void 0;if(r.every(function(t){return t.object.parent.visible!==!0||!e.__isElementInObjects(t.object.parent.el)||(_=t.object,!1)}),!_)return void this.__clearIntersectObject();var h=_.parent.el;if(this.__intersectedEl===h)return;this.__clearIntersectObject(),this.__setIntersectObject(h)}else this.__clearIntersectObject()},__setIntersectObject:function(e){this.__intersectedEl=e,this.__isMobile||(e.addState("hovered"),e.emit("mouseenter"),this.el.addState("hovering"))},__clearIntersectObject:function(){var e=this.__intersectedEl;e&&!this.__isMobile&&(e.removeState("hovered"),e.emit("mouseleave"),this.el.removeState("hovering")),this.__intersectedEl=null},__emit:function(e){var t=this.__intersectedEl;this.el.emit(e,{target:t}),t&&t.emit(e)},__refreshObjects:function(e){var t=this,i=this.__refreshObjects.bind(this);this.objects.forEach(function(e){e.removeEventListener("child-attached",i)}),this.objects=[];var n=document.querySelectorAll(this.data.objects);n.forEach(function(e){e.addEventListener("child-attached",i),t.objects.push(e),t.data.recursive&&t.__addChildren(e)})},__addChildren:function(e){var t=!0,i=!1,n=void 0;try{for(var s,o=e.children[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var r=s.value;this.objects.push(r),this.__addChildren(r)}}catch(e){i=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw n}}},__isElementInObjects:function(e){for(var t=0;t<this.objects.length;t++)if(this.objects[t]===e)return!0;return!1}})},function(e,t){(function(t){function i(e,t){for(var i=-1,n=t.length,s=e.length;++i<n;)e[s+i]=t[i];return e}function n(e,t,o,r,_){var h=-1,c=e.length;for(o||(o=s),_||(_=[]);++h<c;){var a=e[h];t>0&&o(a)?t>1?n(a,t-1,o,r,_):i(_,a):r||(_[_.length]=a)}return _}function s(e){return P(e)||r(e)||!!(w&&e&&e[w])}function o(e){var t=e?e.length:0;return t?n(e,l):[]}function r(e){return h(e)&&g.call(e,"callee")&&(!O.call(e,"callee")||y.call(e)==f)}function _(e){return null!=e&&a(e.length)&&!c(e)}function h(e){return d(e)&&_(e)}function c(e){var t=u(e)?y.call(e):"";return t==b||t==m}function a(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=v}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function d(e){return!!e&&"object"==typeof e}var l=1/0,v=9007199254740991,f="[object Arguments]",b="[object Function]",m="[object GeneratorFunction]",E="object"==typeof t&&t&&t.Object===Object&&t,p="object"==typeof self&&self&&self.Object===Object&&self,j=E||p||Function("return this")(),M=Object.prototype,g=M.hasOwnProperty,y=M.toString,L=j.Symbol,O=M.propertyIsEnumerable,w=L?L.isConcatSpreadable:void 0,P=Array.isArray;e.exports=o}).call(t,function(){return this}())}]);